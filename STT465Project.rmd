---
title: "STT465Project"
author: "Sam Isken"
date: "November 6, 2019"
output: html_document
---

Gave no guidelines on priors, use flat or non-formative priors s

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(faraway)
```

```{r Read in gavote data}
summary(gavote)
head(gavote)
```

STT 465: Final Project
This is an INDIVIDUAL project towards your final exam grades. It counts for 15% of your final course grade and graded out of 100 points.

Since we are considering this project as a final exam, we should uphold all Michigan State University plagiarism policies. That means all individual should complete and submit their own work independently.

# Instructions:

Please read the following instructions carefully and make sure you use the correct data set to do your
own project. If you use a wrong data set for the project, you will automatically lose 40 points.

1. There are 3 different data set and subsequent projects:

(i) If the first initial of your LAST name is A though J, you must do project #1
(ii) If you LAST name starts with letters K - R , you must do project #2
(iii) If you LAST name starts with letters S - Z, you must do project #3

2. The due date for your project is Monday December 9th @ 11:59 p.m. on D2L. You should upload two separate files for your project report:
(i) An R file with all your codes.
(ii) Please write a final project report and save it as a pdf file. An example of a project will be included in the project folder on D2L. This report includes your

(a) Introduction: Where you talk about the dataset and possible question, you wish to answer.

(b) Exploratory Data Analysis: Includes scattered diagrams and histogram with some description about the nature of the response and explanatory variables

(c) Methods: This includes all the analysis that you do.

i. Frequentist regression model (lm() for normal OLS or glm() for Binary outcome - logistic regression in R) using all possible explanatory variables and the resulting interpretations.
ii. Fit a reduced model with explanatory variable that are significant in i. above
iii. Fit a normal Bayesian model or a generalized linear model in the Bayesian framework ( in the case of logistic regression model). 

Note that discussions about your likelihood function, prior and posterior distributions should be included under this subsection. Use flat or non-informative priors or IID normal prior where applicable.

(d) Model diagnosis and Variable selection: Evaluate which explanatory variables are best for predicting the response, check residual plot and Q-Q plot.

(e) Conclusion and discussion: What are you conclusion about the inference? Discuss differences between your best frequentist model and your best Bayesian model. What advantage does one has over the other?

3. The final project report (EXCLUDING THE R file) should be at least 4 pages long and no more than 8 pages.

Disclaimer: The information given here does not; in any way limit your ability to give a detail report of your findings. Please go over your notes and class examples to give you a good idea about what you need to complete this project successfully. There are many materials on the web about Bayesian inference and you are free to consult other notes.

# Data Documentation - Final Project Project # 1

Dataset: gavote

In the 2000 United States Presidential election, there was a lot of controversy especially in Florida where the voting machines were problematic. The Data set gavotte in the package "faraway" contains a sample of 159 individual in the counties of Georgia with 10 variables.

Use help(gavote) in R to learn more about the variable names and dataset.

Issue: A potential voter goes to the polling station where it is determined whether he or she is registered to vote. If so, a ballot is issued. However, a vote is not recorded if the person fails to vot  for President, votes for more than one candidate or the equipment fails to record the vote. For example, we can see that in Appling county, 6617-6099 = 518 ballots did not result in voted for President. This is called the undercount. 

We wish to determine the factors that significantly affects the undercount.

1. Obtain 
```{r}
summary(gavote) 
```
to get summary information about the variables.
2. Obtain the relative undercount:
```{r}
gavote$undercount<- (gavote$ballots - gavote$votes)/gavote$ballots
```
Now, fit appropriate models for undercount as response variable with all possible predictors in the dataset as described in the "Final Project Instruction" document. 

# Introduction 

The 2000 United States Presidential Election was bound to be contentious. George W. Bush, a conservative with a family legacy in the political sphere was running against incumbent Vice President (to Moderate Democrat Bill Clinton) Al Gore. Both ran campaigns focused on domestic issues with some topics of foreign policy sprinkled in. The conservatives emphasized "family values" after the Clinton's scandal regarding Monica Lewinsky while Gore criticized Bush's lack of political experience and conservative policy regarding Healthcare. 

After election night it was clear this election would not go as smoothly as planned. The biggest story to come out was that of the "hanging chad" which made voters in Florida unsure of for whom they were casting their ballot and lead to the famous Florida recount (which was interrupted when a conservative group stormed the offices, led by recently convicted felon Roger Stone)

This paper will focus on another election night controversy, the state of Georgia. We are looking to examine the undercount of votes granularly at the county level. The undercount is defined as the difference between the number of ballots cast and votes recorded for president. Voters may have chosen not to vote for president, voted for more than one candidate (disqualified) or the equipment may have failed to register their choice. There (Citation: "```{r} help(gavote) ```"). Our goal, is to determine the factors that significantly affect the undercount. Our data contains the following variables to assist with this prediction: 

equip: The voting equipment used: LEVER, OS-CC (optical, central count), OS-PC (optical, precinct count) PAPER, PUNCH

econ: economic status of county: middle poor rich

perAA: percent of African Americans in county

rural: indicator of whether county is rural or urban

atlanta: indicator of whether county is in Atlanta or not: notAtlanta

gore: number of votes for Gore

bush: number of votes for Bush

other: number of votes for other candidates

votes: number of votes

ballots: number of ballots

Citation: Meyer M. (2002) Uncounted Votes: Does Voting Equipment Matter? Chance, 15(4), 33-38 & "```{r} help(gavote) ```"


# Results

# Methods 

## Model Building 

## Final Models and Statistical Analysis

## Model Diagnostics

# Conclusion and Detailed Results 

# Future Ideas and Disscussions of Strengths and Weaknesses of the Model 

-------------------------------------------------------------------------------------------------------------------------------------------------

# Workspace 

```{r}
head(gavote)
pairs(gavote)
```

```{r}
# Data Cleaning
head(gavote)
unique(gavote$votes)

gavote$undercount<- (gavote$ballots - gavote$votes)/gavote$ballots
```
Now, fit appropriate models for undercount as response variable with all possible predictors in the dataset as described in the "Final Project Instruction" document. 

```{r}
stepwise_lm_1 <- lm(undercount~.,data=gavote)
summary(stepwise_lm_1)
```
Now letus remove insignificant variables

```{r}
stepwise_lm_2 <- lm(undercount~equip+econ+gore+bush+votes+ballots,data=gavote)
summary(stepwise_lm_2)
plot(stepwise_lm_2)
```


```{r}
remove <- c("FULTON","DEKALB","COBB","BEN.HILL","RANDOLPH","MARION")
gavote <- gavote[!rownames(gavote) %in% remove, ]
```

```{r}
stepwise_lm_3 <- lm(undercount~equip+econ+gore+bush+votes+ballots,data=gavote)
summary(stepwise_lm_3)
plot(stepwise_lm_3)
```



